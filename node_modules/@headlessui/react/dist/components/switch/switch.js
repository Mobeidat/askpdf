import l,{Fragment as k,createContext as x,useContext as A,useMemo as w,useRef as H,useState as F,useEffect as M}from"react";import{forwardRefWithAs as _,render as E,compact as U}from'../../utils/render.js';import{useId as K}from'../../hooks/use-id.js';import{Keys as P}from'../keyboard.js';import{isDisabledReactIssue7711 as B}from'../../utils/bugs.js';import{Label as I,useLabels as O}from'../label/label.js';import{Description as W,useDescriptions as N}from'../description/description.js';import{useResolveButtonType as J}from'../../hooks/use-resolve-button-type.js';import{useSyncRefs as X}from'../../hooks/use-sync-refs.js';import{Hidden as j,Features as $}from'../../internal/hidden.js';import{attemptSubmit as q}from'../../utils/form.js';import{useEvent as u}from'../../hooks/use-event.js';import{useControllable as z}from'../../hooks/use-controllable.js';import{useDisposables as Q}from'../../hooks/use-disposables.js';let b=x(null);b.displayName="GroupContext";let V=k;function Y(p){var t;let[n,c]=F(null),[d,m]=O(),[r,f]=N(),a=w(()=>({switch:n,setSwitch:c,labelledby:d,describedby:r}),[n,c,d,r]),h={},T=p;return l.createElement(f,{name:"Switch.Description"},l.createElement(m,{name:"Switch.Label",props:{htmlFor:(t=a.switch)==null?void 0:t.id,onClick(o){n&&(o.currentTarget.tagName==="LABEL"&&o.preventDefault(),n.click(),n.focus({preventScroll:!0}))}}},l.createElement(b.Provider,{value:a},E({ourProps:h,theirProps:T,defaultTag:V,name:"Switch.Group"}))))}let Z="button";function ee(p,n){let c=K(),{id:d=`headlessui-switch-${c}`,checked:m,defaultChecked:r=!1,onChange:f,name:a,value:h,...T}=p,t=A(b),o=H(null),D=X(o,n,t===null?null:t.setSwitch),[i,s]=z(m,f,r),y=u(()=>s==null?void 0:s(!i)),g=u(e=>{if(B(e.currentTarget))return e.preventDefault();e.preventDefault(),y()}),C=u(e=>{e.key===P.Space?(e.preventDefault(),y()):e.key===P.Enter&&q(e.currentTarget)}),L=u(e=>e.preventDefault()),v=w(()=>({checked:i}),[i]),G={id:d,ref:D,role:"switch",type:J(p,o),tabIndex:0,"aria-checked":i,"aria-labelledby":t==null?void 0:t.labelledby,"aria-describedby":t==null?void 0:t.describedby,onClick:g,onKeyUp:C,onKeyPress:L},R=Q();return M(()=>{var S;let e=(S=o.current)==null?void 0:S.closest("form");e&&r!==void 0&&R.addEventListener(e,"reset",()=>{s(r)})},[o,s]),l.createElement(l.Fragment,null,a!=null&&i&&l.createElement(j,{features:$.Hidden,...U({as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:i,name:a,value:h})}),E({ourProps:G,theirProps:T,slot:v,defaultTag:Z,name:"Switch"}))}let te=_(ee),ne=Y,ve=Object.assign(te,{Group:ne,Label:I,Description:W});export{ve as Switch};
